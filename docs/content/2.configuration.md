---
navigation:
  icon: i-heroicons-cog-6-tooth
title: Configuration
description: Easily configure this module in Nuxt's config file
---

This module can be configured using Nuxt config:

```typescript [nuxt.config.ts]
export default defineNuxtConfig({
  modules: ['nuxt-posthog'],
  posthog: {
    // Configure `nuxt-posthog` module
  },
});
```

### Options

`publicKey`

PostHog's API key. By default it will read `POSTHOG_API_KEY` environment variable from `.env`.

`host`

PostHog's API host. By default it will read `POSTHOG_API_HOST` environment variable from `.env`.

`capturePageViews`

Default to `true`. It will automatically capture page views.

`capturePageLeaves`

Default to `true`. It will automatically capture page leaves.

`clientOptions`

Additional options passed to PostHog's client object.

`disabled`

Default to `false`. If set to `true`, the module will be disabled (no events will be sent to PostHog).
This is useful for development environments. Directives and components will still be available for you to use.

`proxy`

If set to `true`, PostHog will be proxied through the Nuxt server

## GDPR or HIPAA Cookie Compliance

This module supports PostHog's cookieless tracking mode for GDPR/HIPAA compliance. Before configuring cookieless mode, you need to enable "Cookieless server hash mode" in your PostHog project settings under **Project Settings > Web analytics**.

### Cookieless Modes

PostHog supports two cookieless modes:

- **`always`** - Never stores cookies or local storage. No cookie banner needed. Users are tracked using privacy-preserving server-side hashes. Note: `identify()` cannot be called in this mode as it would be considered Personal Data under GDPR.
- **`on_reject`** - Shows a cookie banner and only stores cookies after user consent. If consent is denied, users are still counted using server-side hashes.

### Configuration

```typescript [nuxt.config.ts]
export default defineNuxtConfig({
  modules: ['nuxt-posthog'],
  posthog: {
    // ...
    clientOptions: {
      cookieless_mode: 'on_reject', // or 'always'
    },
  },
});
```

### Building a Cookie Banner

For the **`on_reject`** mode, use the `usePostHogConsent` composable to build your own cookie banner:

```typescript
<template>
  <Transition name="fade">
    <div v-if="consentStatus === 'pending'" class="cookie-banner">
      <div class="cookie-banner__content">
        <p class="cookie-banner__message">We use cookies to analyze site usage and improve your experience.</p>
        <div class="cookie-banner__actions">
          <button @click="handleAccept" class="btn btn--primary">Accept</button>
          <button @click="handleReject" class="btn btn--secondary">Reject</button>
        </div>
      </div>
    </div>
  </Transition>
</template>

<script setup lang="ts">
const { consentStatus, optIn, optOut } = usePostHogConsent();

const handleAccept = () => {
  optIn();
  // Banner will automatically hide after consent is granted
};

const handleReject = () => {
  optOut();
  // Banner will automatically hide after consent is denied
};

// Optional: Watch consent status changes
watch(consentStatus, (newStatus) => {
  console.log('Consent status:', newStatus); // 'pending' | 'granted' | 'denied'
});
</script>
```

### Available Methods

The `usePostHogConsent` composable provides:

- `consentStatus` - A reactive ref containing the
  current consent status: `'pending' | 'granted' | 'denied'`
- `optIn()` - Grant consent and enable tracking (updates `consentStatus` to `'granted'`)
- `optOut()` - Deny consent and disable tracking (updates `consentStatus` to `'denied'`)

The `consentStatus` ref is reactive, so you can use it directly in templates with `v-if` or watch it for changes. The banner will automatically hide when `consentStatus` changes from `'pending'` to either `'granted'` or `'denied'`.

### Limitations

When using cookieless mode, be aware of these limitations:

- **Session replay and surveys** are disabled if
  the user has not given cookie consent
- **Feature flags** may have a slight delay on first load (unless bootstrapped)
- **User identification** across devices is not possible in `always` mode
- **Higher unique user counts** may appear as
  users are tracked differently each day

For more details, see PostHog's [cookieless tracking
documentation](https://posthog.com/tutorials/cookieless-tracking).
